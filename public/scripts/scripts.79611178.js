(function(){"use strict";angular.module("frontApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","ionic","ui.router","ngStorage","toaster"]).config(["$stateProvider","$urlRouterProvider",function(a,b){return a.state("home",{url:"/home",templateUrl:"views/main.html",controller:"MainCtrl"}).state("about",{url:"/about",templateUrl:"views/about.html",controller:"AboutCtrl"}).state("list",{url:"/list",templateUrl:"views/post-list.html",controller:"PostListCtrl"}),b.otherwise("/home")}]).config(["$httpProvider",function(a){return a.defaults.transformRequest=function(a){return void 0===a?a:$.param(a)},a.defaults.headers.post={"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}]).config(["$ionicConfigProvider",function(a){return a.views.transition("none")}])}).call(this),function(){"use strict";angular.module("frontApp").controller("MainCtrl",["$scope","$ionicSideMenuDelegate","Api",function(a,b,c){}])}.call(this),function(){"use strict";angular.module("frontApp").controller("HeaderCtrl",["$scope","$rootScope","$ionicSideMenuDelegate","$ionicModal","$sessionStorage","Api","toaster",function(a,b,c,d,e,f,g){var h;return d.fromTemplateUrl("views/modal-login.html",{scope:a,animation:"slide-in-up"}).then(function(b){a.modal=b}),h=function(){var b;return b={email:"",password:"",password_confirmation:""},a.input=b},h(),a.openModal=function(){return a.modal.show(),c.toggleRight()},a.toggleRight=function(){return c.toggleRight()},a.doLogin=function(){var c;return c={"user[email]":a.input.email,"user[password]":a.input.password},f.getAccessToken(c).then(function(c){return a.modal.hide(),h(),e.email=c.data.email,e.token=c.data.authentication_token,b.isLogin=!0,g.pop({type:"success",title:"ログインしました",showCloseButton:!0})})},a.doLogout=function(){return c.toggleRight(),h(),delete e.token,b.isLogin=!1,g.pop({type:"success",title:"ログアウトしました",showCloseButton:!0})},a.doSignUp=function(){var b;return b={"user[email]":a.input.email,"user[password]":a.input.password,"user[password_confirmation]":a.input.password_confirmation},f.postUser(b).then(function(b){return a.modal.hide(),h()})}}])}.call(this),function(){"use strict";angular.module("frontApp").controller("AboutCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]})}.call(this),function(){"use strict";angular.module("frontApp").controller("PostCtrl",["$scope","$ionicHistory","Api",function(a,b,c){var d;return d=function(){var b;return b={title:"",content:"",quotation_url:"",quotation_name:""},a.input=b},d(),c.getPeople().then(function(b){return a.results=b.data}),a.doPost=function(){var b;return b={"post[title]":a.input.title,"post[content]":a.input.content,"post[quotation_url]":a.input.quotation_url,"post[quotation_name]":a.input.quotation_name},c.postPeople(b).then(function(b){return a.results.push(b.data),d()})},a.doDelete=function(b){return c.deletePeople(a.results[b].id).then(function(c){return a.results.splice(b,1)})},a.goBack=function(){return""===b.backTitle()?b.goBack():location.href="#/home"}}])}.call(this),function(){"use strict";angular.module("frontApp").controller("PostListCtrl",["$scope","$ionicSideMenuDelegate","$ionicModal","$sessionStorage","Api","$http",function(a,b,c,d,e,f){var g,h;return c.fromTemplateUrl("views/modal-post.html",{scope:a,animation:"slide-in-up"}).then(function(b){a.modal=b}),a.categories=[{slug:"episode",name:"歴食エピソード"},{slug:"experience",name:"歴食体験"},{slug:"information",name:"歴食ニュース"}],h=function(){var b;return b={title:"",content:"",quotation_url:"",quotation_name:"",category:a.categories[0],authentication_token:d.token},a.input=b},h(),g={email:d.email,token:d.token},d.token&&e.getPostList(g).then(function(b){return a.results=b.data}),a.openModal=function(){return a.modal.show()},a.editting=!1,a.doPost=function(){var b;return b=new FormData,b.append("token",d.token),b.append("email",d.email),b.append("slug",a.input.category.slug),b.append("post[title]",a.input.title),b.append("post[image]",a.input.file),b.append("post[content]",a.input.content),b.append("post[quotation_url]",a.input.quotation_url),b.append("post[quotation_name]",a.input.quotation_name),e.postPostList(b).then(function(b){return a.results.push(b.data),h(),a.modal.hide()})},a.doDelete=function(b){return g={email:d.email,token:d.token},e.deletePostList(a.results[b].id,g).then(function(c){return a.results.splice(b,1)})},a["new"]=function(){return location.href="#/post"},a.edit=function(){return a.editting=!a.editting},a.$watch("input.file",function(b){var c;return a.srcUrl=void 0,b&&b.type.match("image.*")?(c=new FileReader,c.onload=function(){return a.$apply(function(){return a.srcUrl=c.result})},c.readAsDataURL(b)):void 0})}])}.call(this),function(){"use strict";angular.module("frontApp").factory("Api",["$http","toaster",function(a,b){var c;return c="http://localhost:3000",{getPostList:function(b){return a({method:"GET",url:c+"/posts",params:b}).success(function(a,b,c,d){})},postPostList:function(d){return a({method:"POST",url:c+"/posts.json",transformRequest:null,headers:{"Content-type":void 0},data:d}).success(function(a,c,d,e){return b.pop({type:"success",title:"投稿しました",showCloseButton:!0})})},deletePostList:function(d,e){return a({method:"DELETE",url:c+"/posts/"+d+".json",params:e}).success(function(a,c,d,e){return b.pop({type:"success",title:"削除しました",showCloseButton:!0})})},getAccessToken:function(b){return a({method:"POST",url:c+"/users/sign_in.json",data:b}).success(function(a,b,c,d){})},postUser:function(b){return a({method:"POST",url:c+"/users.json",data:b}).success(function(a,b,c,d){})}}}])}.call(this),function(){"use strict";angular.module("frontApp").directive("fileModel",["$parse",function(a){return{restrict:"A",link:function(b,c,d){var e;return e=a(d.fileModel),c.bind("change",function(){return b.$apply(function(){return e.assign(b,c[0].files[0])})})}}}])}.call(this),angular.module("frontApp").run(["$templateCache",function(a){"use strict";a.put("views/about.html",'<ion-view title=""> <ion-content> <div class="main"> <ul class="item-list"> <li> <div class="sysThumbnailImage"> <img src="http://placehold.jp/440x440.png" class="thumbnail"> </div> <div> <div class="sysItemName">サンプル商品10</div> <div class="sysRetailPrice">価格：12,345円（税抜）</div> </div> <input name="submit" value="カートに入れる" type="submit" class="sysCartButton sysCartInButton"> </li> <li> <div class="sysThumbnailImage"> <img src="http://placehold.jp/440x440.png" class="thumbnail"> </div> <div> <div class="sysItemName">サンプル商品10</div> <div class="sysRetailPrice">価格：12,345円（税抜）</div> </div> <input name="submit" value="カートに入れる" type="submit" class="sysCartButton sysCartInButton"> </li> <li> <div class="sysThumbnailImage"> <img src="http://placehold.jp/440x440.png" class="thumbnail"> </div> <div> <div class="sysItemName">サンプル商品10</div> <div class="sysRetailPrice">価格：12,345円（税抜）</div> </div> <input name="submit" value="カートに入れる" type="submit" class="sysCartButton sysCartInButton"> </li> <li> <div class="sysThumbnailImage"> <img src="http://placehold.jp/440x440.png" class="thumbnail"> </div> <div> <div class="sysItemName">サンプル商品10</div> <div class="sysRetailPrice">価格：12,345円（税抜）</div> </div> <input name="submit" value="カートに入れる" type="submit" class="sysCartButton sysCartInButton"> </li> <li> <div class="sysThumbnailImage"> <img src="http://placehold.jp/440x440.png" class="thumbnail"> </div> <div> <div class="sysItemName">サンプル商品10</div> <div class="sysRetailPrice">価格：12,345円（税抜）</div> </div> <input name="submit" value="カートに入れる" type="submit" class="sysCartButton sysCartInButton"> </li> <li> <div class="sysThumbnailImage"> <img src="http://placehold.jp/440x440.png" class="thumbnail"> </div> <div> <div class="sysItemName">サンプル商品10</div> <div class="sysRetailPrice">価格：12,345円（税抜）</div> </div> <input name="submit" value="カートに入れる" type="submit" class="sysCartButton sysCartInButton"> </li> </ul> </div> </ion-content> </ion-view>'),a.put("views/aside.html",'<ion-content class="aside"> <aside> <nav class="grid-menu"> <a href=""><i class="fa fa-search"></i>検索</a> <a href=""><i class="fa fa-calendar"></i>カレンダー</a> <a href=""><i class="fa fa-envelope"></i>メール</a> <a href=""><i class="fa fa-cog"></i>機能</a> <a href=""><i class="fa fa-list"></i>一覧</a> <a href=""><i class="fa fa-shopping-cart"></i>カート</a> <a href=""><i class="fa fa-smile-o"></i>お気に入り</a> <a href=""><i class="fa fa-camera-retro"></i>ギャラリー</a> <a href=""><i class="fa fa-location-arrow"></i>店舗アクセス</a> <a href=""><i class="fa fa-book"></i>E-Book</a> <a href=""><i class="fa fa-comments-o"></i>Contact</a> <a href=""><i class="fa fa-question-circle"></i>FAQ</a> </nav> <nav class="list-menu"> <ul> <li><a href="">カテゴリ１</a></li> <li><a href="">カテゴリ２</a></li> <li><a href="">カテゴリ３</a></li> <li><a href="">カテゴリ４</a></li> </ul> </nav> </aside> </ion-content>'),a.put("views/main.html",'<ion-view title=""> <ion-content> <div class="main padding"> <a class="button button-block button-dark" href="#/post">新規投稿</a> <table class="table table-striped"> <thead> <tr> <th>件名</th> <th>本文</th> <th>引用元URL</th> <th>引用元名</th> <th></th> </tr> </thead> <tbody> <tr ng-repeat="result in results"> <td>{{result.title}}</td> <td>{{result.content}}</td> <td>{{result.quotation_url}}</td> <td>{{result.quotation_name}}</td> <td align="right"><button class="btn btn-danger" ng-click="doDelete($index)">削除</button></td> </tr> <tr> <td><input type="text" class="form-control" ng-model="input.title"></td> <td><input type="text" class="form-control" ng-model="input.content"></td> <td><input type="text" class="form-control" ng-model="input.quotation_url"></td> <td><input type="text" class="form-control" ng-model="input.quotation_name"></td> <td align="right"><button class="btn btn-primary" ng-click="doPost()">追加</button></td> </tr> </tbody> </table> </div> </ion-content> </ion-view>'),a.put("views/menu.html",'<ion-side-menus> <!-- Left menu --> <ion-side-menu side="right" ng-controller="HeaderCtrl"> <div class="list"> <div class="item item-divider">My Menu</div> <a class="item" ng-click="openModal()" ng-show="!isLogin">ログイン</a> <a class="item" ng-click="doLogout()" ng-show="isLogin">ログアウト</a> </div> </ion-side-menu> <ion-side-menu-content> <ion-nav-bar class="header"> <div class="bar bar-header top"> <h1 class="title">歴食</h1> </div> <nav class="fix-nav" ng-controller="HeaderCtrl"> <a href="#/home"><i class="fa fa-home"></i>HOME</a> <a href="#/about"><i class="fa fa-phone"></i>about</a> <a href="#/list"><i class="fa fa-star"></i>投稿</a> <a href="" ng-click="toggleRight()"><i class="icon ion-navicon-round"></i>MENU</a> <span href="" class="sp-show sp-menu-btn"><i class="fa fa-align-justify"></i>MENU</span> </nav> <!-- <div ng-include="\'views/aside.html\'"></div> --> </ion-nav-bar> <ion-nav-view></ion-nav-view> </ion-side-menu-content> </ion-side-menus>'),a.put("views/modal-login.html",'<ion-modal-view> <ion-header-bar class=""> <h1 class="title">ログイン</h1> </ion-header-bar> <ion-content> <div class="list"> <label class="item item-input"> <span class="input-label">メールアドレス</span> <input type="text" ng-model="input.email"> </label> <label class="item item-input"> <span class="input-label">パスワード</span> <input type="password" ng-model="input.password"> </label> <label class="item item-input"> <span class="input-label">パスワード再入力</span> <input type="password" ng-model="input.password_confirmation"> </label> </div> <div class="padding"> <button class="button button-block button-positive" ng-click="doLogin()">ログイン</button> <button class="button button-block button-positive" ng-click="doSignUp()">アカウント作成</button> </div> </ion-content> </ion-modal-view>'),a.put("views/modal-post.html",'<ion-modal-view class="big-modal"> <ion-header-bar class=""> <h1 class="title">新規投稿</h1> </ion-header-bar> <ion-content> <div class="list"> <label class="item item-input"> <span class="input-label">タイトル</span> <input type="text" ng-model="input.title" ng-required="true"> </label> <div class="item item-input item-thumbnail-right" href="#"> <img class="uploaded-img" ng-if="srcUrl" ng-src="{{srcUrl}}"> <span class="input-label">メイン画像</span> <input type="file" file-model="input.file"> </div> <label class="item item-input"> <span class="input-label">本文</span> <textarea rows="8" ng-model="input.content"></textarea> </label> <label class="item item-input"> <span class="input-label">引用元名</span> <input type="text" ng-model="input.quotation_name"> </label> <label class="item item-input"> <span class="input-label">引用元URL</span> <input type="text" ng-model="input.quotation_url"> </label> <label class="item item-input item-select"> <div class="input-label"> カテゴリー </div> <select ng-model="input.category" ng-options="category.name for category in categories" ng-required="true"> </select> </label> </div> </ion-content> <ion-footer-bar align-title="left" class="bar-stable"> <div class="buttons"> <button class="button">キャンセル</button> </div> <h1 class="title"></h1> <div class="buttons" ng-click="doPost()"> <button class="button">投稿する</button> </div> </ion-footer-bar> </ion-modal-view>'),a.put("views/post-list.html",'<ion-view title=""> <div class="bar bar-subheader bar-clear" align="right"> <button class="button button-assertive" ng-click="edit()">編集</button> <button class="button button-dark" ng-click="openModal()">新規投稿</button> </div> <ion-content class="has-subheader"> <table class="table table-striped"> <thead> <tr> <th>件名</th> <th>本文</th> <th>引用元URL</th> <th>引用元名</th> <th></th> </tr> </thead> <tbody> <tr ng-repeat="result in results"> <td>{{result.title}}</td> <td>{{result.content}}</td> <td>{{result.quotation_url}}</td> <td>{{result.quotation_name}}</td> <td align="right"><button class="btn btn-danger" ng-click="doDelete($index)" ng-show="editting">削除</button></td> </tr> </tbody> </table> </ion-content> </ion-view>')}]);